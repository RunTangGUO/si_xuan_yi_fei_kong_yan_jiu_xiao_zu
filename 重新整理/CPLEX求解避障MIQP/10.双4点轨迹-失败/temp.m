STP=[rT10x rT10y rT10z rT11x rT11y rT11z rT21x rT21y rT21z rT22x rT22y rT22z,...
    rT31x rT31y rT31z rT32x rT32y rT32z rT41x rT41y rT41z rT42x rT42y rT42z,...
    rT51x rT51y rT51z rT52x rT52y rT52z rT61x rT61y rT61z rT62x rT62y rT62z,...
    rT71x rT71y rT71z rT72x rT72y rT72z rT81x rT81y rT81z rT82x rT82y rT82z,...
    dx11 dx21 dx31 dx41 dy11 dy21 dy31 dy41 dz11 dz21 dz31 dz41 ,...
    dx19 dx29 dx39 dx49 dy19 dy29 dy39 dy49 dz19 dz29 dz39 dz49 ,...
    dx1x2 dy1y2 dz1z2,...
    dx2x3 dy2y3 dz2z3,...
    dx3x4 dy3y4 dz3z4,...
    dx4x5 dy4y5 dz4z5,...
    dx5x6 dy5y6 dz5z6,...
    dx6x7 dy6y7 dz6z7,...
    dx7x8 dy7y8 dz7z8];
STA=[1 5 1 3 7 3 3 7 3 6.5 4.5 5.5 ,...
    6.5 4.5 5.5 9 3 8 9 3 8 11 5 9 ,...
    11 5 9 9 7 8 9 7 8 6.5 5.5 5.5 ,...
    6.5 5.5 5.5 2 3 3 2 3 3 1 5 1,...
    0 0 0 0 0 0 0 0 0 0 0 0,...
    0 0 0 0 0 0 0 0 0 0 0 0,...
    0 0 0,...
    0 0 0,...
    0 0 0,...
    0 0 0,...
    0 0 0,...
    0 0 0,...
    0 0 0];
coefficient=sym(zeros(93,27*8));
for i=1:1:93
    parfor j=1:1:27*8
        coefficient(i,j)=STP(i);
        for k=1:1:27*8
            if k~=j
                coefficient(i,j)=subs(coefficient(i,j),rTpL(k),0);
            end
        end
        coefficient(i,j)=coefficient(i,j)/rTpL(j);
    end
end
%逐位计算等式约束中的系数矩阵
% for i=13:1:39
%     for j=1:1:54
%         coefficient(i,j)=STP(i);
%         for k=1:1:54
%             if k~=j
%                 coefficient(i,j)=subs(coefficient(i,j),rTpL(k),0);
%             end
%         end
%         coefficient(i,j)=coefficient(i,j)/rTpL(j);
%     end
% end
save QP_model